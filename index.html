<!-- Note :
   - You can modify the font style and form style to suit your website. 
   - Code lines with comments Do not remove this code are required for the form to work properly, make sure that you do not remove these lines of code. 
   - The Mandatory check script can modified as to suit your business needs. 
   - It is important that you test the modified form before going live.-->
   <style>
    .fsm_wf_inp{
        padding:10px;
    }
    .fsm_wf_inp input,select{
        background-color:white;
        border:#D9E3E8 solid 0.5px;
        padding:8px;
        width:100%;
       font-family:Arial;
       font-size:12px;
        border-radius: 4px;
        width: 240px;
    }.fsm_wf_btn{
        width: fit-content;    padding:8px 16px 8px 16px;
        color:white;
        float:right;
        margin:2px;
        border-radius:5px;
        background-color:#089949;
    }
    .fsm_wf_btns{
        padding-top:10px;
        padding-right:5%;
    }
    .fsm-webform-body{
        margin:auto;
        padding:30px;
        width:500px;
        display:flex;
        justify-content:center;
        background-color:#FFFFFF;
    }
    .fsm_wf_lbl{
        font-family:Arial;
        font-size:12px;
        color:#000000;
        text-align:Left; 
         min-width: 112px;
         padding-right: 40px;
    }
    </style>
    <div id='fsmWebForm' class='fsm-webform-body'>
     <meta name='viewport' content='width=device-width, initial-scale=1.0'>
     <META HTTP-EQUIV ='content-type' CONTENT='text/html;charset=UTF-8'>
     <form name='FsmRequestForm' id = 'FsmRequestForm' accept-charset='UTF-8'>
     <table><tr>
    <td><div class='fsm_wf_lbl'><label for='Summary'>Summary<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Summary' name = 'Summary' required= true ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Company_Name'>Company Name</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Company_Name' name = 'Company_Name' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Contact_Firstname'>First Name</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Contact_Firstname' name = 'Contact_Firstname' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Contact_Lastname'>Last Name<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Contact_Lastname' name = 'Contact_Lastname' required= true ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Email'>Email<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Email' name = 'Email' required= true ftype='email'></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Phone'>Phone<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Phone' name = 'Phone' required= true ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Service_Street_1'>Service Street 1</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Service_Street_1' name = 'Service_Street_1' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Service_City'>Service City<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Service_City' name = 'Service_City' required= true ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Service_State'>Service State</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Service_State' name = 'Service_State' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Service_Country'>Service Country</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Service_Country' name = 'Service_Country' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Billing_Street_1'>Billing Street 1</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Billing_Street_1' name = 'Billing_Street_1' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Billing_City'>Billing City<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Billing_City' name = 'Billing_City' required= true ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Billing_State'>Billing State</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Billing_State' name = 'Billing_State' ></input></div></td>
    </tr> 
    <tr>
    <td><div class='fsm_wf_lbl'><label for='Billing_Country'>Billing Country</label></div></td>
    <td><div class='fsm_wf_inp'><input type='text' id = 'Billing_Country' name = 'Billing_Country' ></input></div></td>
    </tr> 
    <tr style='display:none'>
    <td><div class='fsm_wf_lbl'><label for='Territory'>Territory<span style='color:red;'>*</span></label></div></td>
    <td><div class='fsm_wf_inp'><select id = Territory name= Territory style='font-size:12'>
    <option value=2029000000205221>test1</option>
    </select>
    </table>
    <input style='display:none' type='text' id = 'fsmUniqueKey' value='' name = 'fsmUniqueKey'></input><div class = 'fsm_wf_btns'>
     <input class = 'fsm_wf_btn' type = 'submit' text = 'Submit' name = 'Submit' value = 'Submit' style = 'background-color:#089949; color:#FFFFFF'> </input>
     <input class = 'fsm_wf_btn' type = 'button' text = 'Reset' name = 'Reset' value = 'Reset' style = 'background-color:#f9fafa; color:#55617A' onclick='onResetFsmWebform()'> </input>
     </div>
     </form>
     </div>
     
     <Script>
    document.getElementById("fsmWebForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent the default form submission
        const formData = new URLSearchParams(new FormData(event.target));
        var form = document.getElementById('FsmRequestForm');
        var inputEles = form.getElementsByTagName("input");
        for(let i=0;i<inputEles.length;i++){
            var ele = inputEles[i];
            if(ele.required &#038;&#038; ele.value.trim() == '' &#038;&#038; ele.labels[0]){
                alert('Enter a valid '+ele.labels[0].textContent.slice(0, -1));
                return;
            }
        }
        var selectEles = form.getElementsByTagName("select");
        for(let i=0;i<selectEles.length;i++){
            var ele = selectEles[i];
               if(ele.value == '-None-'){
                if(ele.required && ele.labels[0]){
                     alert('Enter a valid '+ele.labels[0].textContent.slice(0, -1));
                     return;
                }
                else{
                    formData.set(ele.id,'')
                }
             }
        }
        var emailFld = form.querySelectorAll('[ftype=email]');
        for (let i = 0; i < emailFld.length; i++)
        {
            var emailVal = emailFld[i].value;
            if((emailVal=='')||(emailVal==null)){
               continue;
            }
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if(!emailRegex.test(emailVal)){
               alert('Enter a valid mail Address');
               return false;
            }
        }
           formData.set('timeZoneOffset',new Date().getTimezoneOffset());
           form.getElementsByClassName("fsm_wf_btn").Submit.disabled=true;
        fetch('https://fsm.zoho.com/fsm/_Customers/webformResponse?fsmdigest=64d796720823d50e54e00de31ad4da2ffc7ad3052c88eabd090d294c93463fc88875954733ff311027138a0181b0db9ea59d654a989d9a5c5447152d15978144', {
            method: 'POST',
            body: formData
        })
        .then(async function(response){
                  form.getElementsByClassName("fsm_wf_btn").Submit.disabled=false;
               let responseObj = JSON.parse(await response.text());
               if (!response.ok) {
                   throw responseObj;
               }
               return responseObj;
         })
         .then(data => {
             if(data.status=="Success"){
                 alert("form submitted successfully")
                 form = document.getElementById('FsmRequestForm');
                 form.reset(); 
                window.location.href = 'https://fsm.zoho.com/';          
              }
             else{
                 throw new Error('error in form submission');
             }
           })
         .catch(error => {
                form.getElementsByClassName("fsm_wf_btn").Submit.disabled=false;
             if(error.message && error.ErrorCode){
                 alert(error.message);
             }
             else{
                 alert("Unable to submit form");
             }
         });
    });
    function onResetFsmWebform(){
         let fsmform = document.getElementById('FsmRequestForm');
         fsmform.reset();
                window.location.href = 'https://fsm.zoho.com/';
    }
    </Script>